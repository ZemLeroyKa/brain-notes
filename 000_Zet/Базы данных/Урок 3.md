# Многотабличные базы данных

`TableName = "Teachers"`

| Name    | BirthDate  | Faculty | Phone | Group | Subject   |
| ------- | ---------- | ------- | ----- | ----- | --------- |
| Sophia  | 1984-12-08 | КТУ     | +3563 | 1166  | ТАУ       |
| Emma    |            | ФИТИП   | +1937 | 2166  | Философия |
| Henry   |            | ЕН      | +2967 |       |           |
| Michael |            | ЕН      | +2967 |       |           |
| Daniel  | 1979-07-30 | КТУ     | +3563 | 1165  | SQL       |
| Sophia  | 1984-12-08 | КТУ     | +3563 | 1166  | Сопромат  |
| Daniel  | 1979-07-30 | ФИТИП   | +1937 | 2265  | SQL       |
|         |            |         |       |       |           |
|         |            |         |       |       |           |

С какими проблемами столкнёмся при работе с такой таблицей?

## Аномалии обновления
> [!Summary] Дублирование информации приводит к издержкам менеджмента изменений

Существует два вида избыточности
- Явная
- Неявная

Явная избыточность выражается в дублировании одинаковой информации, например, данные педагогов (ФИО, Факультет)

Неявная избыточность проявляется в виде неявной зависимости между различными записями одной таблицы (номер телефона факультета)

## Аномалии вставки
> [!Summary] Неполнота информации запрещает ввод известной части информации, что ведёт к полной потере или временным задержкам.


Если в таблице есть поля с обязательным требованием заполнения, то без информации для этого поля пользователь будет вынужден соврать или ждать неопределённое время до выяснения истиной информации. 

## Аномалии удаления
> [!Summary] Удаление информации приводит к потере связей и/или связанной информации

Например, при увольнении педагога потеряется информации о его предмете, группе, расписании и так далее.


## Принципы создания многотабличных баз данных
- Фрагментация больших массивов информации.
- Оптимизация схем данных.
- Устранение аномалий баз данных.

## Внешний ключ
Внешний ключ (Foreign Key) — поле таблицы, в котором содержится значение первичного ключа другой таблицы. 
![[Students-Groups tables.excalidraw]]


## Типы связей

### Один к одному
Teachers — Authentifications
На каждого пользователя - свой логин и пароль.

Разделение такого рода происходит ради дефрагментации либо безопасности.

Доступы к таблице по CRUD
Create Read Update Delete

Запись на схемах (ER-диаграммах) происходит через прямую линию.
### Один ко многим
Самый частый вид связей. 
Строке в первой таблице соответствует множество строк во второй таблице. 
Группа — Студенты
Графически представляется в виде линии, один конец которой оканчивается трезубцем. Трезубец называют "вороньей лапкой" (Crow's foot)

### Многие ко многим
Множество строк первой таблицы соответствует множеству строк со второй таблицы и наоборот.

Графически тип связи обозначается пунктирной линией с трезубцами по сторонам, НО, фактически такая связь в настоящих базах данных изображается с применением промежуточной таблицы.

![[Teachers-TeachersGroups-Groups tables.excalidraw]]

## Скрипт запроса к нескольким таблицам
```sql
SELECT G.Id, G.Name AS GroupName, F.Name AS FacultyName
FROM Groups AS G, Faculties AS F
WHERE G.FacultyId = F.Id;
```

